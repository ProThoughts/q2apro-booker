!function(t){function a(){t.ajax({url:p,cache:!1}).done(function(t){g.html('<div class="vbox-inline">'+t+"</div>"),d(!0)}).fail(function(){g.html('<div class="vbox-inline"><p>Error retrieving contents, please retry</div>'),d(!0)})}function e(){g.html('<iframe class="venoframe" src="'+p+'"></iframe>'),d()}function o(t){var a=p.split("/"),e=a[a.length-1],o=t?"?autoplay=1":"";g.html('<iframe class="venoframe" webkitallowfullscreen mozallowfullscreen allowfullscreen frameborder="0" src="//player.vimeo.com/video/'+e+o+'"></iframe>'),d()}function i(t){var a=(p.split("/"),n(p)),e=t?"?autoplay=1":"";g.html('<iframe class="venoframe" webkitallowfullscreen mozallowfullscreen allowfullscreen src="//www.youtube.com/embed/'+a+e+'"></iframe>'),d()}function n(t){var a=/^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#\&\?]*).*/,e=t.match(a);return e&&11==e[7].length?e[7]:!1}function r(){g.html('<div class="vbox-inline">'+t(p).html()+"</div>"),d()}function l(){X=t(".vbox-content").find("img"),X.one("load",function(){d()}).each(function(){this.complete&&t(this).load()})}function d(){m.html(A),g.find(">:first-child").addClass("figlio"),t(".figlio").css("width",j).css("height",q).css("padding",b).css("background",v),J=g.outerHeight(),I=t(window).height(),I>J+80?(E=(I-J)/2,g.css("margin-top",E),g.css("margin-bottom",E)):(g.css("margin-top","40px"),g.css("margin-bottom","40px")),g.animate({opacity:"1"},"slow")}function c(){t(".vbox-content").length&&(J=g.height(),I=t(window).height(),I>J+80?(E=(I-J)/2,g.css("margin-top",E),g.css("margin-bottom",E)):(g.css("margin-top","40px"),g.css("margin-bottom","40px")))}var s,v,f,m,b,h,u,g,p,x,y,w,k,C,j,q,z,H,D,E,L,P,Q,X,A,B,F,G,I,J,K,M;t.fn.extend({venobox:function(n){var d={framewidth:"",frameheight:"",border:"0",bgcolor:"#fff",titleattr:"title",numeratio:!1,infinigall:!1,overlayclose:!0},c=t.extend(d,n);return this.each(function(){var n=t(this);return n.data("venobox")?!0:(n.addClass("vbox-item"),n.data("framewidth",c.framewidth),n.data("frameheight",c.frameheight),n.data("border",c.border),n.data("bgcolor",c.bgcolor),n.data("numeratio",c.numeratio),n.data("infinigall",c.infinigall),n.data("overlayclose",c.overlayclose),n.data("venobox",!0),void n.click(function(d){function E(){B=n.data("gall"),L=n.data("numeratio"),z=n.data("infinigall"),H=t('.vbox-item[data-gall="'+B+'"]'),H.length>1&&L===!0?(f.html(H.index(n)+1+" / "+H.length),f.show()):f.hide(),F=H.eq(H.index(n)+1),G=H.eq(H.index(n)-1),n.attr(c.titleattr)?(A=n.attr(c.titleattr),m.show()):(A="",m.hide()),H.length>1&&z===!0?(K=!0,M=!0,F.length<1&&(F=H.eq(0)),H.index(n)<1&&(G=H.eq(H.index(H.length)))):(F.length>0?(t(".vbox-next").css("display","block"),K=!0):(t(".vbox-next").css("display","none"),K=!1),H.index(n)>0?(t(".vbox-prev").css("display","block"),M=!0):(t(".vbox-prev").css("display","none"),M=!1))}function X(t){27===t.keyCode&&I()}function I(){t("body").removeClass("vbox-open"),t("body").unbind("keydown",X),Q.animate({opacity:0},500,function(){Q.remove(),D=!1,n.focus()})}d.stopPropagation(),d.preventDefault(),n=t(this),P=n.data("overlay"),j=n.data("framewidth"),q=n.data("frameheight"),s=n.data("autoplay")||!1,b=n.data("border"),v=n.data("bgcolor"),K=!1,M=!1,D=!1,p=n.data("href")||n.attr("href"),k=n.data("css")||"",t("body").addClass("vbox-open"),h='<div class="vbox-overlay '+k+'" style="background:'+P+'"><div class="vbox-preloader">Loading...</div><div class="vbox-container"><div class="vbox-content"></div></div><div class="vbox-title"></div><div class="vbox-num">0/0</div><div class="vbox-close">X</div><div class="vbox-next">next</div><div class="vbox-prev">prev</div></div>',t("body").append(h),Q=t(".vbox-overlay"),u=t(".vbox-container"),g=t(".vbox-content"),f=t(".vbox-num"),m=t(".vbox-title"),g.html(""),g.css("opacity","0"),E(),Q.css("min-height",t(window).outerHeight()),Q.animate({opacity:1},250,function(){"iframe"==n.data("type")?e():"inline"==n.data("type")?r():"ajax"==n.data("type")?a():"vimeo"==n.data("type")?o(s):"youtube"==n.data("type")?i(s):(g.html('<img src="'+p+'">'),l())});var J={prev:function(){D||(D=!0,P=G.data("overlay"),j=G.data("framewidth"),q=G.data("frameheight"),b=G.data("border"),v=G.data("bgcolor"),p=G.data("href")||G.attr("href"),s=G.data("autoplay"),A=G.attr(c.titleattr)?G.attr(c.titleattr):"",void 0===P&&(P=""),g.animate({opacity:0},500,function(){Q.css("background",P),"iframe"==G.data("type")?e():"inline"==G.data("type")?r():"ajax"==G.data("type")?a():"youtube"==G.data("type")?i(s):"vimeo"==G.data("type")?o(s):(g.html('<img src="'+p+'">'),l()),n=G,E(),D=!1}))},next:function(){D||(D=!0,P=F.data("overlay"),j=F.data("framewidth"),q=F.data("frameheight"),b=F.data("border"),v=F.data("bgcolor"),p=F.data("href")||F.attr("href"),s=F.data("autoplay"),A=F.attr(c.titleattr)?F.attr(c.titleattr):"",void 0===P&&(P=""),g.animate({opacity:0},500,function(){Q.css("background",P),"iframe"==F.data("type")?e():"inline"==F.data("type")?r():"ajax"==F.data("type")?a():"youtube"==F.data("type")?i(s):"vimeo"==F.data("type")?o(s):(g.html('<img src="'+p+'">'),l()),n=F,E(),D=!1}))}};t("body").keydown(function(t){37==t.keyCode&&1==M&&J.prev(),39==t.keyCode&&1==K&&J.next()}),t(".vbox-prev").click(function(){J.prev()}),t(".vbox-next").click(function(){J.next()});var N=".vbox-close, .vbox-overlay";return n.data("overlayclose")||(N=".vbox-close"),t(N).click(function(a){x=".figlio",w=".vbox-prev",y=".vbox-next",C=".figlio *",t(a.target).is(x)||t(a.target).is(y)||t(a.target).is(w)||t(a.target).is(C)||I()}),t("body").keydown(X),!1}))})}}),t(window).resize(function(){c()})}(jQuery);